================================================================================
TIER 0: SHOW-STOPPING SECURITY ISSUES
Fix ALL of these before anyone uses the platform.
================================================================================

S1. STORAGE BUCKET "posts" IS PUBLIC
-------------------------------------
Severity:   CRITICAL — defeats entire monetization model
Location:   Supabase Storage → "posts" bucket
Impact:     Anyone with a raw Supabase storage URL can download ALL "premium"
            content directly, completely bypassing RLS and paywalls. A single
            cURL command or right-click "Copy Image URL" gives direct access to
            every photo and video on the platform.
Fix:        1. Make the "posts" bucket PRIVATE (public = false)
            2. Switch all media serving to createSignedUrl() with short expiry
               (e.g., 60 seconds for images, 3600 for video playback)
            3. Only generate signed URLs for users who pass the access check
               (subscriber, purchaser, or creator themselves)
Files:      - Supabase dashboard → Storage → posts bucket settings
            - src/lib/storage.js (getPublicUrl → createSignedUrl)
            - src/stores/postStore.js (line ~188, getPublicUrl usage)
            - src/components/feed/PostCard.jsx (media URL rendering)

S2. ALL MEDIA USES getPublicUrl()
----------------------------------
Severity:   CRITICAL — architectural blocker for content protection
Location:   src/lib/storage.js (lines 35-37, 65-67)
            src/stores/postStore.js (line ~188)
Impact:     Even after fixing S1 to make the bucket private, every single
            media reference in the codebase calls getPublicUrl() which
            generates a permanent, unauthenticated URL. These won't work with
            a private bucket. The entire media pipeline must be refactored.
Fix:        1. Create a getMediaUrl(bucket, path, { isProtected }) function
            2. For public content (avatars, banners): keep getPublicUrl()
            3. For protected content (posts, PPV): use createSignedUrl()
            4. Add server-side access check before generating signed URL
               (or use Supabase Edge Function as a proxy)
            5. Consider caching signed URLs in memory for their TTL duration
Files:      - src/lib/storage.js (complete refactor of URL generation)
            - src/stores/postStore.js (media URL handling in fetchPosts)
            - src/components/feed/PostCard.jsx (MediaGrid URL consumption)
            - All components that display post media

S3. NO SECURITY HEADERS
-------------------------
Severity:   HIGH
Location:   Missing vercel.json configuration file
Impact:     No Content-Security-Policy, no X-Frame-Options, no HSTS,
            no X-Content-Type-Options headers. This leaves the platform
            vulnerable to XSS injection, clickjacking, and MIME-sniffing
            attacks. For a platform handling sensitive user content and
            payment information, this is unacceptable.
Fix:        Create vercel.json with headers:
            {
              "headers": [
                {
                  "source": "/(.*)",
                  "headers": [
                    { "key": "X-Frame-Options", "value": "DENY" },
                    { "key": "X-Content-Type-Options", "value": "nosniff" },
                    { "key": "Referrer-Policy", "value": "strict-origin-when-cross-origin" },
                    { "key": "Permissions-Policy", "value": "camera=(), microphone=(), geolocation=()" },
                    { "key": "Strict-Transport-Security", "value": "max-age=63072000; includeSubDomains; preload" },
                    { "key": "Content-Security-Policy", "value": "default-src 'self'; img-src 'self' https://agoekmugbrswrdjscwek.supabase.co blob: data:; media-src 'self' https://agoekmugbrswrdjscwek.supabase.co blob:; connect-src 'self' https://agoekmugbrswrdjscwek.supabase.co wss://agoekmugbrswrdjscwek.supabase.co; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';" }
                  ]
                }
              ]
            }
Files:      - vercel.json (create new)

S4. NO RATE LIMITING
---------------------
Severity:   HIGH
Location:   No Vercel middleware, no Supabase rate limits beyond defaults
Impact:     Bots could scrape all public content, brute-force authentication,
            spam creator inboxes, or flood the API with requests. Supabase
            has default connection pool limits but no per-user rate limiting.
Fix:        1. Add Vercel Edge Middleware for basic rate limiting
               (or use Vercel's built-in WAF on Pro plan)
            2. Configure Supabase rate limiting via Dashboard → API settings
            3. Add client-side debouncing on all mutation endpoints
            4. Consider Cloudflare in front of Vercel for DDoS protection
Files:      - middleware.js (create new — Vercel Edge Middleware)
            - src/stores/*.js (add debouncing to mutation calls)

S5. VERIFICATION DOCUMENTS UPLOADED TO PUBLIC BUCKET
-----------------------------------------------------
Severity:   CRITICAL — legal/privacy catastrophe
Location:   src/pages/BecomeCreatorPage.jsx
Impact:     Government-issued photo IDs submitted during creator verification
            are uploaded to the PUBLIC "avatars" storage bucket. Anyone can
            access these files directly. This is a massive privacy violation
            and potential legal liability (GDPR, state privacy laws, etc.)
Fix:        1. Create a new PRIVATE "verification-docs" storage bucket
            2. Add RLS policies: only the user and admins can read
            3. Update BecomeCreatorPage to upload to the correct bucket
            4. Add server-side cleanup (auto-delete after verification)
Files:      - Supabase dashboard → Storage (create bucket)
            - New migration for verification-docs bucket policies  
            - src/pages/BecomeCreatorPage.jsx (bucket name change)

S6. NO AGE VERIFICATION
-------------------------
Severity:   CRITICAL — legal requirement for adult content
Location:   Entire platform — no age gate exists
Impact:     Operating an adult content platform without age verification
            violates laws in most jurisdictions. Many US states now require
            age verification for adult websites. EU regulations also apply.
            Without this, the platform cannot legally operate.
Fix:        1. Add age verification gate on first visit (DOB + checkbox minimum)
            2. Consider third-party age verification service integration
               (Yoti, AgeChecker.net, etc.) for jurisdictions requiring it
            3. Store age verification status in user profile
            4. Block access to NSFW content without verification
Files:      - New AgeGate component
            - src/App.jsx (wrap routes with age gate)
            - src/stores/authStore.js (track verification status)

S7. NO 2257 COMPLIANCE
------------------------
Severity:   CRITICAL — federal law for adult content (US)
Location:   Entire platform — no compliance infrastructure
Impact:     18 U.S.C. § 2257 requires producers of sexually explicit content
            to maintain records of age verification for all performers.
            Non-compliance is a federal criminal offense.
Fix:        1. Add 2257 compliance page (required disclosures)
            2. Require creators to confirm age and maintain records
            3. Add 2257 statement link in footer
            4. Implement record-keeping system for creator verification docs
Files:      - New compliance page
            - Footer component update
            - Creator onboarding flow update

S8. NO COOKIE CONSENT / PRIVACY POLICY
----------------------------------------
Severity:   HIGH — GDPR/CCPA requirement
Location:   Entire platform
Impact:     Using Supabase auth (which sets cookies) and potentially analytics
            without cookie consent violates GDPR. No privacy policy page exists.
            No terms of service page exists.
Fix:        1. Add cookie consent banner
            2. Create Privacy Policy page
            3. Create Terms of Service page
            4. Link from footer and registration flow
Files:      - New CookieConsent component
            - New legal pages (Privacy, Terms, 2257)
            - Footer/layout updates
